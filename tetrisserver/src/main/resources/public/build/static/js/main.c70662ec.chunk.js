(this.webpackJsonpreduxtetris=this.webpackJsonpreduxtetris||[]).push([[0],{18:function(e,t,n){e.exports=n(30)},23:function(e,t,n){},29:function(e,t,n){e.exports=n.p+"static/media/johnnyFever.dac54f72.ttf"},30:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(5),a=n.n(i),c=(n(23),n(15)),s=n(1),u=function(e){var t=e.key,n=function(t){var n;switch(e.gameOver&&(t="e"),t){case"e":n="#111929";break;case"b":n="deepSkyBlue";break;case"o":n="orangered";break;case"g":n="lime";break;case"p":n="slateblue";break;case"br":n="red";break;case"y":n="gold";break;case"r":n="deeppink";break;default:n="pink"}return{height:"26px",width:"26px",display:"inline-block",margin:"0px 2px",border:"1px solid rgba(255,255,255, .3)",borderColor:"e"===t?"rgba(255,255,255,.3)":"#111929",background:n,position:"relative",opacity:".9"}}(e.value);return o.a.createElement("div",{style:n,key:t,className:e.isInFullRow||e.gameOver?"t".concat(""+e.index," animated"):""})},l=function(e){var t=e.rowId,n=e.row.map((function(n,r){return o.a.createElement(u,{key:""+r+t,value:n,isInFullRow:e.isFull,index:r,gameOver:e.gameOver})}));return o.a.createElement("div",{key:t,style:{padding:0}},n)},d=n(2),h=n(7),f=function e(t,n,r){var o=this;Object(d.a)(this,e),this.value=void 0,this.rowId=void 0,this.columnId=void 0,this.blockToLeft=function(){return new e(o.value,o.rowId,o.columnId-1)},this.blockToRight=function(){return new e(o.value,o.rowId,o.columnId+1)},this.blockBelow=function(){return new e(o.value,o.rowId+1,o.columnId)},this.isEqualTo=function(e){return e.rowId===o.rowId&&e.columnId===o.columnId},this.columnId=r,this.rowId=n,this.value=t},v=function(){function e(t,n){var r=this;if(Object(d.a)(this,e),this.currentPosition=void 0,this.lockCurrentPosition=!1,this.nextPosition=void 0,this.board=void 0,this.axis=void 0,this.newPiece=!1,this.getNextPosition=function(){return r.nextPosition},this.board=t,n)this.currentPosition=n,this.nextPosition=n,this.axis=n[0];else{var o=this.generate();this.currentPosition=o,this.nextPosition=o,this.axis=o[0]}}return Object(h.a)(e,[{key:"removeFromBoard",value:function(e){return this.currentPosition.forEach((function(t){e[t.rowId][t.columnId]="e"})),e}},{key:"addToBoard",value:function(e){return this.currentPosition.forEach((function(t){e[t.rowId][t.columnId]=t.value})),e}},{key:"addNextToBoard",value:function(e){return this.nextPosition.forEach((function(t){e[t.rowId][t.columnId]=t.value})),e}},{key:"rotate",value:function(){var e=this,t=this.currentPosition.map((function(t,n){var r=-1*(e.axis.rowId-t.rowId)+e.axis.columnId,o=e.axis.columnId-t.columnId+e.axis.rowId;return new f(t.value,o,r)}));return!!this.isValidPosition(t)&&(this.setNextPosition(t),!0)}},{key:"move",value:function(e){var t=this.currentPosition.map((function(t){switch(e){case"ArrowLeft":return t.blockToLeft();case"ArrowRight":return t.blockToRight();case"ArrowDown":return t.blockBelow();default:return t}}));return this.isValidPosition(t)?(this.setNextPosition(t),!0):"ArrowDown"===e&&(this.setNextPosition(this.generate()),this.lockCurrentPosition=!0,!0)}},{key:"isValidPosition",value:function(e){var t=this.currentPosition.map((function(e){return JSON.stringify(e)})),n=e.filter((function(e){return!t.includes(JSON.stringify(e))})),r=!0,o=!1,i=void 0;try{for(var a,c=n[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var s=a.value;if(s.rowId===this.board.length)return!1;try{if("e"!==this.board[s.rowId][s.columnId])return!1}catch(u){return!1}}}catch(l){o=!0,i=l}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return!0}},{key:"setNextPosition",value:function(e){this.nextPosition=e}},{key:"generate",value:function(){var e,t=["o","t","s","z","l","j","i"];switch(t[Math.floor(Math.random()*t.length)]){case"o":e=[new f("b",0,4),new f("b",0,5),new f("b",1,4),new f("b",1,5)];break;case"t":e=[new f("o",1,5),new f("o",0,5),new f("o",1,4),new f("o",1,6)];break;case"s":e=[new f("g",0,4),new f("g",1,3),new f("g",0,5),new f("g",1,4)];break;case"z":e=[new f("p",1,5),new f("p",0,4),new f("p",0,5),new f("p",1,6)];break;case"l":e=[new f("y",0,4),new f("y",0,3),new f("y",0,5),new f("y",1,3)];break;case"j":e=[new f("br",0,4),new f("br",0,5),new f("br",0,3),new f("br",1,5)];break;case"i":e=[new f("r",0,5),new f("r",0,4),new f("r",0,3),new f("r",0,6)];break;default:e=[new f("b",0,4),new f("b",0,5),new f("b",1,4),new f("b",1,5)]}return this.newPiece=!0,e}}]),e}(),w=function e(t,n){Object(d.a)(this,e),this.rowId=void 0,this.blocks=void 0,this.isFull=void 0,this.rowId=t,this.blocks=n.map((function(e,n){return new f(e,t,n)})),this.isFull=!n.includes("e")},b=function e(t){var n=this;Object(d.a)(this,e),this.rows=void 0,this.boardArray=void 0,this.nextBoard=void 0,this.getFullRows=function(){var e=[];return n.rows.forEach((function(t,n){t.isFull&&e.push(n)})),e},this.removeFullRows=function(e){return console.log("remove full rows"),e.forEach((function(e){for(;e>=0;)n.nextBoard[e-1]?n.nextBoard[e]=n.nextBoard[e-1]:n.nextBoard[e]=["e","e","e","e","e","e","e","e","e","e"],e--})),n.nextBoard},this.boardArray=t,this.nextBoard=t,this.rows=t.map((function(e,t){return new w(t,e)}))},g=n(8),m=n(16),p=n(14),y=n(17);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(e){function t(){var e,n;Object(d.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={name:""},n.commonStyle={display:"block",backgroundColor:"transparent",color:"white",border:"3px solid white",borderRadius:"10px",fontFamily:"johnnyFever",margin:"auto",fontSize:"26px",maxWidth:"80%"},n.buttonStyle=k({},n.commonStyle,{cursor:"pointer",marginTop:"26px"}),n.inputStyle=k({},n.commonStyle,{textAlign:"center"}),n.handleChange=function(e){n.setState({name:e.target.value})},n.submit=function(){if(3===n.state.name.length){var e=JSON.stringify({name:n.state.name,score:n.props.score});fetch("/insertOne",{method:"POST",redirect:"follow",body:e}).then((function(e){return window.location.href="/allScores"}))}},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("p",null,"enter your name"),o.a.createElement("input",{style:this.inputStyle,type:"text",onChange:function(t){return e.handleChange(t)},value:this.state.name,maxLength:3}),o.a.createElement("button",{onClick:this.submit,style:this.buttonStyle},"submit"))}}]),t}(o.a.Component);n(29);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){var t;t=e.gameStarted?e.gameOver?"game over":"use the arrow keys to play":"click here to play!";var n,r=e.highScores?o.a.createElement("ol",{style:{fontSize:"20px"}},e.highScores.map((function(e){return o.a.createElement("li",{style:{padding:"0px"}},"".concat(e.name," : ").concat(e.score," PTS"))}))):o.a.createElement("div",null,"Loading high scores...");n=e.gameOver?o.a.createElement(x,{score:e.score}):r;var i=e.gameStarted?"initial":"pointer",a={border:"3px solid rgba(255,255,255,.3)",height:"150px",width:"250px",color:"white",lineHeight:"150px",fontSize:"75px",marginLeft:"25px",marginBottom:"10px",borderRadius:"15px",textAlign:"center",fontFamily:"johnnyFever"};return o.a.createElement("div",null,o.a.createElement("div",{style:a},e.score),o.a.createElement("div",{style:E({},a,{height:"435px",lineHeight:"initial"})},"Tetris",o.a.createElement("div",{style:{fontSize:"30px",cursor:i},onClick:e.gameStarted?function(){}:e.startGame},t,n)))},S=function(){var e=Object(s.c)((function(e){return e.board})),t=Object(s.c)((function(e){return e.currentPiece})),n=Object(s.c)((function(e){return e.score})),r=Object(s.c)((function(e){return e.gravityActive})),i=Object(s.c)((function(e){return e.newPiece})),a=Object(s.c)((function(e){return e.gameOver})),u=Object(s.c)((function(e){return e.gameStarted})),d=Object(s.c)((function(e){return e.highScores})),h=Object(s.b)();void 0===d&&(console.log("---FETCHING---"),fetch("/getTopTen").then((function(e){return e.json()})).then((function(e){return h({type:"SET_SCORES",scores:e})})));var f=Object(c.a)(e),w=new v(e,t),g=new b(e),m=i?g.getFullRows():[],p=new Boolean(m.length).valueOf();if(m.length){var y=n+Math.pow(2,m.length),O=w.removeFromBoard(f);O=g.removeFullRows(m),O=w.addToBoard(O),setTimeout((function(){h({type:"REMOVE_FULL_ROWS",board:O,score:y})}),400)}var k=function(){u&&(w.lockCurrentPosition||(f=w.removeFromBoard(f)),f=w.addNextToBoard(f),console.log("UPDATE"),h({type:"UPDATE",board:f,currentPiecePosition:w.nextPosition,newPiece:w.newPiece,gravityActive:!0,score:n,gameStarted:!0,highScores:d}))};document.addEventListener("keydown",(function e(t){["ArrowLeft","ArrowRight","ArrowDown"].includes(t.key)&&w.move(t.key)&&!p&&(document.removeEventListener("keydown",e),w.isValidPosition(w.nextPosition)?k():h({type:"GAME_OVER"}));"ArrowUp"===t.key&&w.rotate()&&!p&&(document.removeEventListener("keydown",e),k())}));return u&&!r&&setInterval((function(){var e=new KeyboardEvent("keydown",{key:"ArrowDown"});document.dispatchEvent(e)}),500),o.a.createElement("div",{style:{display:"flex",paddingTop:"30px",justifyContent:"center"}},o.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},e.map((function(e,t){return o.a.createElement(l,{key:t,row:e,rowId:t,isFull:m.includes(t),gameOver:a})}))),o.a.createElement(j,{score:n,gameOver:a,startGame:function(){console.log("start game"),h({type:"START_GAME"})},gameStarted:u,highScores:d}))},I=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var T=n(6),R={board:[["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"],["e","e","e","e","e","e","e","e","e","e"]],currentPiece:void 0,gravityActive:!1,score:0,gameOver:!1,gameStarted:!1,highScores:void 0},F=Object(T.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE":return{board:t.board,currentPiece:t.currentPiecePosition,gravityActive:!0,newPiece:t.newPiece,score:t.score,gameStarted:!0,highScores:t.highScores};case"REMOVE_FULL_ROWS":return Object.assign(e,{board:t.board},{newPiece:!1},{score:t.score});case"GAME_OVER":return Object.assign(e,{gameOver:!0});case"START_GAME":return Object.assign(e,{gameStarted:!0});case"SET_SCORES":Object.assign(e,{highScores:t.scores});default:return e}}));a.a.render(o.a.createElement(s.a,{store:F},o.a.createElement(S,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");I?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):A(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):A(t,e)}))}}()}},[[18,1,2]]]);
//# sourceMappingURL=main.c70662ec.chunk.js.map